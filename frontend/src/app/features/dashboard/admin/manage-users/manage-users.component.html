<div class="dashboard-content">
  <div class="mb-3">
    <div>
      <h2 class="section-title">Gerir Usuários</h2>
      <p class="section-subtitle small">Gera e monitore todos <strong>usuários</strong></p>
    </div>
    <div class="filters mb-4">
      <input
        type="text"
        placeholder="Pesquisar usuários..."
        class="form-control filter-input"
      />
      <select class="form-select filter-select">
        <option>Todos os status</option>
        <option>Ativo</option>
        <option>Desativado</option>
      </select>
      <select class="form-select filter-select">
        <option>Todas as funções</option>
        <option>Admin</option>
        <option>Provedor</option>
        <option>Buscador</option>
      </select>
      <button class="btn btn-outline-secondary">Exportar</button>
      <button class="btn btn-primary">+ Novo Usuário</button>
    </div>
  </div>

  <!-- Skeleton -->
<div *ngIf="isLoading" class="row g-4">
  <div class="col-md-6 col-lg-4" *ngFor="let _ of [1, 2, 3]">
    <div class="card user-card h-100 loading">
      <div class="card-body">
        <div class="skeleton skeleton-title mb-3"></div>
        <div class="skeleton skeleton-text mb-2"></div>
        <div class="skeleton skeleton-text short"></div>
      </div>
      <div class="card-footer d-flex gap-2">
        <div class="skeleton skeleton-btn"></div>
      </div>
    </div>
  </div>
</div>

<!-- Empty State -->
<div *ngIf="!isLoading && users.length === 0" class="empty-state text-center">
  <i class="bi bi-people"></i>
  <p class="lead">Nenhum usuário registado.</p>
</div>

  <div *ngIf="!isLoading && users.length > 0" class="row g-4">
    <div class="col-md-6 col-lg-4" *ngFor="let user of users">
      <div class="card user-card h-100 position-relative">
        <div class="card-body">
          <div class="d-flex align-items-center gap-3 mb-3">
            <div class="avatar rounded-circle d-flex align-items-center justify-content-center fw-bold">
              {{ user.username.charAt(0) }}
            </div>
            <div>
              <h5 class="card-title">{{ user.username }}</h5>
              <small>{{ user.email }}</small>
            </div>
          </div>

          <div class="mb-2 user-roles">
            <span *ngFor="let role of user.roles" class="badge me-1"
              [ngClass]="{
                'badge-admin': role === 'ADMIN',
                'badge-provider': role === 'SERVICE_PROVIDER',
                'badge-seeker': role === 'SERVICE_SEEKER'
              }">
              {{ getFriendlyRole(role) }}
            </span>
          </div>

          <div class="mb-2">
            <div>
              <strong class="card-text">Status: </strong>
              <span class="badge" [ngClass]="user.enabled ? 'badge-success' : 'badge-danger'">
                {{ user.enabled ? 'Ativo' : 'Desativado' }}
              </span>
            </div>
            <div class="card-text">
              <strong>Registado:</strong>
              {{ user.id | date: 'dd MMM yyyy' }}
            </div>
          </div>

          <div class="text-muted small">
            <i class="bi bi-circle-fill text-success me-1" *ngIf="user.enabled"></i>
            Online agora
          </div>
        </div>

        <div class="card-footer d-flex justify-content-end">
          <button class="btn btn-sm d-flex align-items-center gap-1"
            [ngClass]="user.enabled ? 'btn-outline-warning' : 'btn-outline-success'"
            (click)="toggleUserStatus(user)">
            <i class="bi" [ngClass]="user.enabled ? 'bi-person-dash' : 'bi-person-check'"></i>
            {{ user.enabled ? 'Desativar' : 'Ativar' }}
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
